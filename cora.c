#include<stdio.h>
#include<stdlib.h>
#include<time.h>

//sparse matrix edge_index 2*10556
#define Edge_Number  586
int edge_row[Edge_Number]={1285, 1285, 1286, 1287, 1287, 1287, 1287, 1288, 1288, 1289, 1289, 1290, 1290, 1290, 1291, 1291, 1291, 1292, 1292, 1292, 1293, 1293, 1293, 1294, 1294, 1295, 1295, 1296, 1296, 1296, 1296, 1296, 1296, 1296, 1296, 1297, 1297, 1297, 1298, 1299, 1299, 1299, 1300, 1300, 1300, 1300, 1300, 1300, 1300, 1300, 1300, 1301, 1301, 1301, 1301, 1301, 1301, 1302, 1303, 1303, 1303, 1303, 1303, 1304, 1304, 1304, 1305, 1305, 1306, 1306, 1307, 1307, 1307, 1307, 1307, 1308, 1308, 1308, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1309, 1310, 1311, 1311, 1311, 1311, 1312, 1312, 1312, 1313, 1313, 1313, 1313, 1313, 1314, 1314, 1314, 1315, 1315, 1316, 1316, 1316, 1316, 1317, 1317, 1317, 1317, 1317, 1317, 1317, 1317, 1317, 1317, 1317, 1318, 1318, 1318, 1319, 1319, 1320, 1320, 1320, 1320, 1321, 1322, 1322, 1323, 1324, 1324, 1325, 1325, 1325, 1325, 1325, 1325, 1326, 1326, 1327, 1327, 1327, 1328, 1328, 1328, 1329, 1329, 1329, 1330, 1330, 1330, 1331, 1331, 1331, 1332, 1332, 1332, 1333, 1333, 1333, 1333, 1334, 1334, 1334, 1334, 1334, 1335, 1335, 1335, 1336, 1336, 1336, 1336, 1336, 1336, 1336, 1336, 1337, 1337, 1337, 1337, 1338, 1338, 1338, 1339, 1339, 1339, 1340, 1340, 1340, 1340, 1341, 1341, 1341, 1342, 1342, 1343, 1343, 1343, 1343, 1343, 1343, 1343, 1344, 1344, 1344, 1344, 1344, 1345, 1345, 1346, 1346, 1346, 1346, 1347, 1347, 1348, 1348, 1348, 1348, 1349, 1349, 1349, 1349, 1350, 1351, 1351, 1351, 1351, 1351, 1351, 1351, 1351, 1351, 1351, 1352, 1353, 1353, 1354, 1354, 1354, 1354, 1355, 1355, 1356, 1357, 1357, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1358, 1359, 1359, 1359, 1359, 1359, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1361, 1361, 1362, 1362, 1362, 1363, 1363, 1364, 1365, 1365, 1365, 1365, 1366, 1366, 1366, 1367, 1367, 1367, 1367, 1367, 1367, 1367, 1367, 1367, 1367, 1368, 1368, 1368, 1369, 1369, 1369, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1370, 1371, 1372, 1372, 1373, 1373, 1373, 1374, 1375, 1376, 1376, 1376, 1377, 1377, 1377, 1377, 1377, 1378, 1378, 1378, 1379, 1379, 1380, 1380, 1380, 1381, 1381, 1382, 1382, 1382, 1382, 1382, 1383, 1383, 1384, 1384, 1385, 1385, 1385, 1386, 1386, 1386, 1387, 1388, 1388, 1388, 1388, 1388, 1388, 1389, 1389, 1389, 1390, 1390, 1391, 1392, 1392, 1392, 1393, 1394, 1394, 1394, 1395, 1395, 1395, 1395, 1395, 1395, 1396, 1396, 1396, 1396, 1396, 1396, 1397, 1398, 1398, 1399, 1399, 1399, 1399, 1399, 1400, 1400, 1401, 1401, 1401, 1401, 1401, 1402, 1402, 1402, 1402, 1402, 1403, 1403, 1403, 1404, 1405, 1405, 1405, 1405, 1406, 1406, 1407, 1408, 1408, 1408, 1408};
int edge_col[Edge_Number]={711, 2182, 538, 59, 481, 1164, 1358, 88, 1309, 1622, 1705, 212, 1213, 2258, 1224, 1660, 2154, 689, 1317, 1358, 65, 1013, 2418, 352, 733, 1171, 1987, 35, 440, 728, 895, 1910, 1911, 1912, 1913, 316, 598, 766, 2703, 598, 1701, 1810, 251, 507, 812, 877, 1542, 1933, 1940, 1941, 2508, 25, 598, 1315, 1316, 1542, 2140, 1006, 95, 746, 979, 1026, 2163, 505, 937, 1180, 466, 1358, 364, 1317, 802, 804, 922, 1444, 2536, 1229, 1254, 1627, 61, 88, 415, 490, 851, 995, 1288, 1338, 1625, 1677, 1741, 1882, 2015, 2102, 2103, 2178, 2692, 468, 1312, 1313, 2080, 904, 1311, 1313, 468, 573, 1311, 1312, 2407, 514, 890, 1269, 17, 1301, 17, 927, 1301, 1679, 689, 796, 1040, 1148, 1292, 1306, 1719, 1720, 1739, 2220, 2221, 12, 2661, 2662, 186, 2034, 1050, 1349, 1491, 2684, 2501, 63, 2265, 1701, 2035, 2265, 298, 327, 1000, 1095, 2063, 2247, 928, 2063, 495, 1328, 2161, 495, 1327, 2160, 78, 733, 994, 1204, 1837, 2068, 310, 1576, 1810, 436, 621, 2024, 749, 1973, 2195, 2312, 1542, 1577, 1701, 1941, 1950, 1856, 2087, 2090, 86, 695, 1012, 1452, 1797, 2032, 2033, 2034, 109, 563, 1701, 2045, 1309, 1912, 2385, 154, 1358, 1753, 872, 1413, 1542, 1943, 868, 1224, 2425, 1050, 1230, 118, 255, 836, 1507, 1645, 2165, 2316, 25, 724, 815, 1928, 2315, 202, 353, 109, 306, 519, 1670, 281, 1997, 218, 1810, 2163, 2605, 39, 1320, 1634, 2684, 1443, 69, 262, 604, 907, 1362, 1535, 1592, 1972, 2134, 2282, 506, 97, 661, 371, 400, 1183, 2270, 1171, 1957, 1613, 2025, 2170, 30, 34, 53, 59, 68, 72, 73, 90, 101, 111, 154, 155, 156, 170, 173, 174, 228, 244, 246, 289, 326, 333, 337, 341, 346, 357, 364, 466, 489, 501, 524, 552, 580, 609, 613, 616, 626, 645, 684, 686, 687, 689, 708, 744, 748, 754, 757, 758, 764, 796, 797, 819, 823, 831, 853, 873, 876, 882, 902, 919, 929, 951, 957, 970, 978, 985, 999, 1038, 1040, 1041, 1070, 1072, 1103, 1123, 1145, 1149, 1154, 1169, 1189, 1205, 1209, 1229, 1238, 1243, 1281, 1284, 1287, 1292, 1305, 1339, 1384, 1389, 1444, 1471, 1480, 1483, 1492, 1499, 1516, 1546, 1550, 1562, 1565, 1568, 1599, 1604, 1620, 1646, 1708, 1709, 1710, 1711, 1712, 1713, 1714, 1715, 1716, 1717, 1718, 1719, 1720, 1721, 1722, 1723, 1724, 1725, 1726, 1727, 1728, 1729, 1730, 1731, 1732, 1733, 1734, 1735, 1736, 1737, 1738, 1739, 1740, 1741, 1742, 1743, 1744, 1745, 1746, 1747, 1748, 1749, 1750, 1751, 1752, 1753, 1754, 1755, 1756, 1757, 1758, 1759, 1760, 1761, 1762, 1763, 1764, 1765, 1766, 2597, 181, 1464, 1914, 2278, 2480, 541, 647, 904, 1650, 1902, 1904, 1960, 2491, 565, 1528, 1351, 1372, 1914, 507, 1413, 40, 1702, 1703, 2509, 2519, 368, 1194, 2248, 124, 306, 484, 980, 1196, 1584, 1656, 1778, 2080, 2143, 702, 1911, 2553, 1094, 1530, 1653, 778, 779, 1224, 1525, 1919, 1975, 2274, 2485, 1393, 42, 1362, 518, 848, 1003, 748, 2586, 239, 1848, 2232, 1840, 2068, 2069, 2070, 2388, 1544, 2058, 2150, 1380, 2564, 1050, 1379, 2564, 798, 1794, 218, 281, 1502, 2176, 2283, 403, 806, 1229, 1358, 714, 1015, 2335, 727, 2570, 2571, 1190, 257, 734, 736, 964, 2181, 2197, 341, 1358, 2597, 856, 2681, 1693, 51, 710, 2212, 1371, 88, 211, 2137, 679, 948, 2072, 2189, 2266, 2267, 1399, 1421, 2109, 2228, 2394, 2395, 861, 565, 1528, 1396, 1501, 2227, 2309, 2394, 886, 2698, 89, 258, 761, 1153, 1585, 1163, 1482, 1616, 1919, 1972, 465, 1013, 2317, 2375, 229, 1053, 1508, 1894, 922, 2387, 1263, 370, 1553, 1826, 1828};
//feature x  2708 1433
#define rows  2000
#define cols  1
int feature[rows*cols]={0, 0, 0, 11, 2, 8, 0, 5, 2, 2, 0, 0, 5, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 2, 0, 0, 9, 3, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 7, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 3, 8, 3, 0, 7, 1, 3, 0, 10, 4, 0, 0, 0, 0, 0, 0, 1, 3, 0, 0, 0, 13, 0, 7, 0, 3, 0, 1, 4, 8, 3, 0, 6, 1, 0, 0, 0, 0, 0, 8, 3, 0, 0, 0, 3, 15, 5, 1, 0, 0, 0, 0, 5, 1, 0, 2, 0, 6, 0, 3, 0, 0, 0, 6, 6, 1, 0, 3, 1, 2, 0, 0, 0, 0, 0, 7, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 6, 2, 0, 0, 5, 2, 0, 3, 0, 0, 0, 0, 7, 2, 3, 0, 0, 0, 0, 9, 6, 2, 0, 2, 0, 3, 0, 3, 0, 6, 0, 12, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 3, 6, 2, 0, 2, 0, 4, 0, 0, 13, 4, 0, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 7, 10, 0, 0, 0, 4, 0, 0, 0, 6, 0, 0, 0, 0, 8, 3, 2, 0, 1, 0, 6, 0, 0, 0, 0, 0, 3, 0, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 3, 10, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 1, 0, 8, 1, 0, 7, 1, 3, 6, 4, 3, 0, 0, 1, 10, 0, 0, 8, 9, 1, 0, 0, 7, 0, 1, 0, 6, 0, 0, 0, 7, 0, 5, 1, 0, 2, 1, 8, 6, 0, 5, 1, 0, 0, 12, 2, 0, 3, 0, 0, 0, 0, 2, 3, 0, 0, 6, 1, 4, 0, 4, 3, 0, 0, 1, 3, 0, 0, 6, 0, 4, 8, 0, 1, 0, 0, 0, 0, 4, 0, 1, 0, 9, 0, 8, 5, 4, 0, 0, 13, 0, 6, 0, 1, 9, 0, 5, 2, 4, 0, 0, 14, 0, 0, 0, 6, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 7, 0, 0, 0, 0, 0, 2, 0, 7, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 4, 0, 0, 5, 0, 15, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 6, 0, 3, 7, 4, 0, 2, 8, 9, 3, 0, 4, 0, 7, 0, 2, 1, 0, 7, 5, 0, 0, 0, 0, 2, 1, 0, 0, 1, 0, 4, 0, 6, 2, 0, 0, 0, 0, 0, 0, 3, 0, 0, 8, 0, 5, 7, 14, 2, 0, 4, 0, 0, 0, 0, 0, 6, 1, 0, 4, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 7, 1, 1, 0, 0, 0, 3, 0, 0, 0, 2, 0, 0, 1, 1, 0, 6, 0, 10, 3, 0, 0, 0, 10, 1, 2, 0, 0, 0, 0, 5, 0, 0, 0, 6, 2, 1, 0, 0, 5, 2, 5, 0, 0, 0, 0, 0, 5, 0, 5, 4, 4, 2, 0, 1, 12, 4, 0, 5, 1, 0, 0, 0, 3, 0, 6, 0, 0, 0, 0, 0};
int output_data[rows*cols]={0};
#define nnz 586
int val[nnz];

void read_data() {
    FILE *file = fopen("output.txt", "r");
    if (file == NULL) {
        perror("Failed to open file");
        return ;
    }
    int i = 0, j = 0;
    //initialize val
        for(int i=0;i<nnz;i++){
            val[i] = 1;
        }

    //read edge_row
            for (j = 0; j < Edge_Number; j++) {
                if (fscanf(file, "%d", (edge_row+j)) != 1) {
                    fprintf(stderr, "File read error\n");
                    return ;
                }
            }
    //read edge_col
            for (j = 0; j < Edge_Number; j++) {
                if (fscanf(file, "%d", (edge_col+j)) != 1) {
                    fprintf(stderr, "File read error\n");
                    return ;
                }
            }
    // read feature x
    for (i = 0; i < rows; i++) {
            for (j = 0; j < cols; j++) {
                if (fscanf(file, "%d", feature+i*cols+j) != 1) {
                    fprintf(stderr, "File read error\n");
                    return ;
                }
            }
    }
        fclose(file);
}
void print_data(){
        for (int j = 0; j < Edge_Number; j++) {
          printf("%d ",edge_row[j]);
        }
        printf("\n");
        printf("\n");
        printf("\n");
    for (int j = 0; j < Edge_Number; j++) {
          printf("%d ",edge_col[j]);
        }
        printf("\n");
        printf("\n");
        printf("\n");
    for (int j = 0; j < rows*cols; j++) {
          printf("%d ",feature[j]);
        }
        printf("\n");
}


__attribute__((noinline))
void cora(){       

  int i = 0;
  int j = 0;
  int temp;
  int X = nnz * cols;
  int x = 0;
  for (x = 0; x < X; ++x) {
    #ifdef CGRA_COMPILER
            please_map_me();
    #endif
    i = x / cols;
    j = x - cols*i;
    temp = val[i] * feature[ edge_col[i]*cols + j ];
    //  printf("feature[%d]=%d,val[%d]=%d\n",edge_col[i]*cols + j ,feature[ edge_col[i]*cols + j ],i,val[i]);
    output_data[ edge_row[i]*cols + j ] += temp;
    //   printf("output_data[%d]=%d temp=%d\n",edge_row[i]*cols+j,output_data[edge_row[i]*cols+j],temp);
  }

}

int main(){

    // read_data();
    // print_data();
    cora();
    return 0;
}